var tglApiClient=new function(){var t,n={apiKey:"AIzaSyC5Fw0sHmxEg7-S1iylkQ68WN6X2rlGq8M",authDomain:"tgl-api-20e32.firebaseapp.com",databaseURL:"https://tgl-api-20e32.firebaseio.com"};firebase.initializeApp(n),this.auth=new function(){firebase.auth().onAuthStateChanged(function(n){t=n?n:null}),this.signInWithApiKey=function(t,n,e){var i=0;firebase.auth().onAuthStateChanged(function(o){var s=0==i;i++,o?(console.log("Already logged in."),n&&s&&n()):$.ajax({type:"GET",url:"https://api.thegreenlion.net/AuthService.svc/LogInWithApiKey?key="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){console.log("API login successfull"),firebase.auth().signInWithCustomToken(t.Token).then(function(t){console.log("Firebase login successfull"),n&&s&&n()},function(t){e&&s&&e(t)})},failure:function(t){console.log("Failed obtaining token"),e&&s&&e(t)}})})}},this.content=new function(){this.listContacts=function(t,n){this.listDocuments("contacts",t,n)},this.getContact=function(t,n,e){this.getDocument(t,n,e)},this.listCountries=function(t,n){this.listDocuments("countries",t,n)},this.getCountry=function(t,n,e){this.getDocument(t,n,e)},this.listLocations=function(t,n){this.listDocuments("locations",t,n)},this.getLocation=function(t,n,e){this.getDocument(t,n,e)},this.listPrograms=function(t,n){this.listDocuments("programs",t,n)},this.getProgram=function(t,n,e){this.getDocument(t,n,e)},this.listDocuments=function(n,e,i){firebase.database().ref("/users/"+t.uid).once("value").then(function(t){firebase.database().ref("/permissions/"+t.val().agentId+"/"+n).once("value").then(function(t){e&&e(Object.keys(t.val()))},function(t){i&&i(t)})},function(t){i&&i(t)})},this.getDocument=function(t,n,e){firebase.database().ref("/content/"+t).once("value").then(function(t){console.log(t.val()),n&&n(t.val())},function(t){e&&e(t)})}}};