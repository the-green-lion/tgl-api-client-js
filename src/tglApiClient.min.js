var tglApiClient=new function(){var t,n={apiKey:"AIzaSyC5Fw0sHmxEg7-S1iylkQ68WN6X2rlGq8M",authDomain:"tgl-api-20e32.firebaseapp.com",databaseURL:"https://tgl-api-20e32.firebaseio.com"};firebase.initializeApp(n),this.auth=new function(){firebase.auth().onAuthStateChanged(function(n){t=n?n:null}),this.signInWithApiKey=function(t,n,e){var i=0;firebase.auth().onAuthStateChanged(function(a){var s=0==i;i++,a&&a.uid==t?n&&s&&n():$.ajax({type:"POST",url:"https://api.thegreenlion.net/user/"+t+"/authenticate",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){firebase.auth().signInWithCustomToken(t.token).then(function(t){n&&s&&n()},function(t){e&&s&&e(t)})},failure:function(t){e&&s&&e(t)}})})}},this.content=new function(){this.listContacts=function(t,n){this.listDocuments("contacts",t,n)},this.getContact=function(t,n,e){this.getDocument(t,n,e)},this.listCountries=function(t,n){this.listDocuments("countries",t,n)},this.getCountry=function(t,n,e){this.getDocument(t,n,e)},this.listLocations=function(t,n){this.listDocuments("locations",t,n)},this.getLocation=function(t,n,e){this.getDocument(t,n,e)},this.listPrograms=function(t,n){this.listDocuments("programs",t,n)},this.getProgram=function(t,n,e){this.getDocument(t,n,e)},this.listDocuments=function(n,e,i){firebase.database().ref("/users/"+t.uid).once("value").then(function(t){firebase.database().ref("/permissions/"+t.val().agentId+"/"+n).once("value").then(function(t){e&&e(Object.keys(t.val()))},function(t){i&&i(t)})},function(t){i&&i(t)})},this.getDocument=function(t,n,e){firebase.database().ref("/content/"+t).once("value").then(function(t){n&&n(t.val())},function(t){e&&e(t)})}},this.bookings=new function(){function n(n,i,a,s,o,c){t.getToken(!1).then(function(t){$.ajax({type:n,url:e+i+"?auth="+t+a,data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",success:o,error:c})}).catch(function(t){c&&c(t)})}var e="https://api.thegreenlion.net/bookings";this.list=function(t,e,i,a){var s="&page="+e;t.hasOwnProperty("isCanceled")&&(s+="&iscanceled="+t.isCanceled),t.hasOwnProperty("dateStartBefore")&&(s+="&dateStartBefore="+t.dateStartBefore),t.hasOwnProperty("dateStartafter")&&(s+="&dateStartafter="+t.dateStartafter),t.hasOwnProperty("reference")&&(s+="&reference="+t.reference),t.hasOwnProperty("email")&&(s+="&email="+t.email),n("GET","",s,null,i,a)},this.get=function(t,e,i){n("GET","/"+t,"",null,e,i)},this.create=function(t,e,i){n("POST","","",t,e,i)},this.update=function(t,e,i,a){n("PUT","/"+t,"",e,i,a)},this.cancel=function(t,e,i){n("DELETE","/"+t,"",null,e,i)}}};