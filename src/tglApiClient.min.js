var tglApiClient=new function(){var t=null,n={authDomain:"identity.thegreenlion.net",apiKey:"AIzaSyC5Fw0sHmxEg7-S1iylkQ68WN6X2rlGq8M",databaseURL:"https://tgl-api-20e32.firebaseio.com"};firebase.initializeApp(n),this.endpointBaseUrl="https://api.thegreenlion.net/",$.ajaxSetup({converters:{"text json":function(t){return""==t?null:JSON.parse(t)}}}),this.refresh=function(t,e){firebase.app().delete().then(function(){firebase.initializeApp(n),t&&t()},function(){e&&e()})},this.auth=new function(){firebase.auth().onAuthStateChanged(function(n){t=n?n:null}),this.signInWithEmailAndPassword=function(t,n,e,i){var o=encodeURIComponent(t);this.signIn(o,n,e,i)},this.signIn=function(n,e,i,o){var a=firebase.auth().onAuthStateChanged(function(s){a(),s&&s.uid==n?i&&i():jQuery.ajax({type:"GET",url:tglApiClient.endpointBaseUrl+"auth/user/"+n+"/authenticate?secret="+e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){firebase.auth().signInWithCustomToken(n.token).then(function(n){t=n,i&&i()},function(t){o&&o(t)})},error:function(t){o&&o(t)}})})},this.getToken=function(n,e){return null==t?void(e&&e()):void t.getToken(!1).then(function(t){n&&n(t)}).catch(function(t){e&&e(t)})}},this.admin=new function(){this.changePassword=function(n,e,i,o){t.getToken(!1).then(function(t){jQuery.ajax({type:"POST",url:tglApiClient.endpointBaseUrl+"admin/user/me/secret/change?currentsecret="+n+"&newsecret="+e+"&auth="+t,success:i,error:o})}).catch(function(t){o&&o(t)})}},this.content=new function(){this.listContacts=function(t,n){this.listDocuments("contacts",t,n)},this.getContact=function(t,n,e){this.getDocument(t,n,e)},this.listCountries=function(t,n){this.listDocuments("country",t,n)},this.getCountry=function(t,n,e){this.getDocument(t,n,e)},this.listLocations=function(t,n){this.listDocuments("location",t,n)},this.getLocation=function(t,n,e){this.getDocument(t,n,e)},this.listPrograms=function(t,n){this.listDocuments("program",t,n)},this.getProgram=function(t,n,e){this.getDocument(t,n,e)},this.listDocuments=function(n,e,i){firebase.database().ref("/users/"+t.uid).once("value").then(function(t){firebase.database().ref("/content_index/"+t.val().organizationId+"/"+n+"_by_id/all").once("value").then(function(t){e&&e(Object.keys(t.val()))},function(t){i&&i(t)})},function(t){i&&i(t)})},this.getDocument=function(t,n,e){firebase.database().ref("/content/"+t).once("value").then(function(t){n&&n(t.val())},function(t){e&&e(t)})}},this.booking=new function(){function n(t,n,i,o,a,s){var r="&page="+o;i.hasOwnProperty("isCanceled")&&(r+="&iscanceled="+i.isCanceled),i.hasOwnProperty("dateStartBefore")&&(r+="&dateStartBefore="+i.dateStartBefore),i.hasOwnProperty("dateStartafter")&&(r+="&dateStartafter="+i.dateStartafter),i.hasOwnProperty("reference")&&(r+="&reference="+i.reference),i.hasOwnProperty("email")&&(r+="&email="+i.email),e("GET",t,n,"",r,null,a,s)}function e(n,e,i,o,a,s,r,c){t.getToken(!1).then(function(t){jQuery.ajax({type:n,url:tglApiClient.endpointBaseUrl+"booking/"+e+"/"+i+"/bookings"+o+"?auth="+t+a,data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",success:r,error:c})}).catch(function(t){c&&c(t)})}this.listBookingsOfUser=function(t,e,i,o,a){n("user",t,e,i,o,a)},this.listBookingsOfOrganization=function(t,e,i,o,a){n("organization",t,e,i,o,a)},this.getBookingOfUser=function(t,n,i,o){e("GET","user",t,"/"+n,"",null,i,o)},this.getBookingOfOrganization=function(t,n,i,o){e("GET","organization",t,"/"+n,"",null,i,o)},this.createBookingOfUser=function(t,n,i,o){e("POST","user",t,"","",n,i,o)},this.updateBookingOfUser=function(t,n,i,o,a){e("PUT","user",t,"/"+n,"",i,o,a)},this.updateBookingOfOrganization=function(t,n,i,o,a){e("PUT","organization",t,"/"+n,"",i,o,a)},this.cancelBookingOfUser=function(t,n,i,o){e("DELETE","user",t,"/"+n,"",null,i,o)},this.cancelBookingOfOrganization=function(t,n,i,o){e("DELETE","organization",t,"/"+n,"",null,i,o)}}};